#### epilogue
Модуль клиентской службы доставки.

#### Постановление задания
Необходимо создать модуль клиентской службы доставки (Sales->Shipping Methods). Модуль должен уметь работать с основным функционалом для служб доставки (которые идут из коробки М2). Дополнительно модуль должен уметь:
 
 - загружать `CSV` файлы с информацией по странах и ценах доставки
 - валидировать данные вводимые пользователем
 - валидировать загружаемый файл
 - возвращать данные по ценам и странам (для клиентской службы доставки) в формате `CSV`
 - etc
 
 #### Выполнение задания
 Для работы выбрана стабильная версия Magento 2.3.
 Написание происходило согласно термину Magento Way.
 Для создания скриптов работы с БД написаны декларативные схемы (появились с М2.3).
 ###### валидация
 Валидация файла выполнена посредством AJAX скриптов для чего было написано отдельное правило: "`custom-validate-csv-file`". Правило применено в `system.xml`.
 
 ###### выгрузка `CSV`
 Выгрузка файла выполнена через AJAX  запрос. При выгрузке создается новый `CSV` файл на основе данных из БД. Т.е. ранее загруженные файлы (если их несколько) не используются для выгрузки. 
 
 ###### перезапись старых цен
 Модуль предоставляет администратору возможность определить как записывать новые данные из `CSV` файл: 
 - перезаписать цены для стран (в БД) которые есть и в файле и БД
 - не перезаписывать и в таком случает на этапе оформления заказа будет выбрана та цена, которая была внесена в БД последней. В данном случает ответсвенность несет администратор
 
 ###### тестирование 
Для тестирования выбраны новые `MFTF` тесты (стабильная версия доступна с версии М2.3. На более ранних версия тестирование используя `MFTF` затруднительно).
Предварительно нужно установить `MFTF`. Тутор для установки  [здесь](https://devdocs.magento.com/mftf/2.3/getting-started.html).

Тест кейсы:
- загрузка невалидного файла
- загрузка валидного файла
- сохранение данных
- выгрузка `CSV` файла
- создание нового товара для покупки
- покупка нового товара
- оформление доставки
- выбор страны для доставки, которая есть в предварительно загруженном `CSV` файле
- выбор страны для доставки, которой нет в предварительно загруженном `CSV` файле
- тестирование расчета стоимость дефолтной доставки
- etc (всего `24 asserts`);

В директории _files есть примеры валидных/не валидных файлов. Их нужно поместить (для тестирования) в директорию _data (`dev->tests->acceptance->tests->_data`). Эти файлы изменять нельзя, т.к. `MFTF` (тесты в самом модуле) имеют hard-code привязку к ценам, которые внесены в валидный `CSV` файл.
Команда для запуска тестов (предварительно нужно выпольнить генерирование тестов):

`vendor/bin/mftf run:test -f CheckImportExportProcessTest --remove`

 Команда для генерирования тестов:
 
 `vendor/bin/mftf generate:tests -f CheckImportExportProcessTest`
